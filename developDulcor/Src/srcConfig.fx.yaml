"srcConfig As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    BackgroundImage: ='FondoHomeSinLogo-dulcor2'
    ImagePosition: =ImagePosition.Fill
    LoadingSpinnerColor: =RGBA(100, 118, 132, 1)
    OnVisible: |-
        =UpdateContext({ cloneData : seguimientoFacturasCollect, soloSinGuardar: false, mostrarModalRefresh:false})

    Header_8 As Header:
        COLORheader1: =RGBA(237, 237, 237, 1)
        txtTituloInput: ="Sincronizar Datos"

    "galConfigEstados As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        BorderColor: =RGBA(32, 54, 71, 1)
        Height: =52
        Items: =estadoRecepcionOpcionesCollect
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =0
        Width: =426
        WrapCount: =3
        X: =10
        Y: =87
        ZIndex: =2

        Title10_2 As label:
            Align: =Align.Center
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: |
                =Switch(ThisItem.nombre,
                "Recibido", RGBA(152, 208, 70, 1),
                "Observado", RGBA(255, 255, 0, 1),
                "Rechazado", RGBA(255, 0, 0, 1))
            FontWeight: =FontWeight.Semibold
            HoverFill: =RGBA(204, 204, 204, 1)
            OnSelect: |-
                =UpdateContext({ estado_recepcion1: ThisItem.nombre })
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.nombre
            Width: =140
            X: =
            ZIndex: =1

        NextArrow10_2 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(32, 54, 71, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =1
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            TabIndex: =0
            Tooltip: ="Ver los detalles del elemento"
            Visible: =false
            Width: =60
            X: =Parent.TemplateWidth - Self.Width - 5
            ZIndex: =2

        Separator10_2 As rectangle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =RGBA(32, 54, 71, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Visible: =false
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =3

    Label7 As label:
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =27
        Size: =11
        Text: ="Mostrar por estado de recepción "
        Width: =320
        X: =5
        Y: =60
        ZIndex: =3

    Label7_1 As label:
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =27
        Size: =11
        Text: ="Mostrando  " & Text(galConfigEstados.Selected.nombre) & " y  Offline" //If(soloSinGuardar;"Offline"; "Online")
        Width: =320
        X: =10
        Y: =139
        ZIndex: =4

    btnNoOnline_1 As button:
        Color: =RGBA(90, 106, 119, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(230, 230, 230, 1)
        Height: =45
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(100, 118, 132, 1), -20%)
        OnSelect: |-
            =UpdateContext({ soloSinGuardar1: true})
        Size: =11
        Text: ="Offline"
        Visible: =false
        Width: =84
        X: =455
        Y: =87
        ZIndex: =5

    Image2 As image:
        BorderColor: =RGBA(32, 54, 71, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =49
        Image: =sincronizar
        Width: =69
        X: =476
        Y: =6
        ZIndex: =6

    btnSync As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayMode: =If(Connection.Connected,DisplayMode.Edit,Disabled)
        Fill: =RGBA(0, 0, 0, 0)
        FontWeight: =FontWeight.Semibold
        Height: =50
        HoverBorderColor: =
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =
        OnSelect: |-
            =UpdateContext({ mostrarModalRefresh:true});
            If(
                Connection.Connected,
                UpdateContext(
                    {
                        ListaNuevos: 
                    //DropColumns(
            Filter(//registros que estan con bandera offline y id principal para seperar los nuevos
                            seguimientoFacturasCollect,
                            Online = false && Or(
                                IsEmpty(pss_seguimientocomprobantesid),
                                IsBlank(pss_seguimientocomprobantesid)
                            )
                        ),
                        //);"IdLocal"; "Online");
                        ListaModificados: Filter(//registros que estan con bandera offline y id principal que no estan vacios para separar los modificados
                            seguimientoFacturasCollect,
                            Online = false && And(
                                !IsEmpty(pss_seguimientocomprobantesid),
                                !IsBlank(pss_seguimientocomprobantesid)
                            )
                        )
                    }
                );
                
            //resguardo nuevos TODO: de momento no se crean nuevos 
            /*
            ForAll(
                    ListaNuevos As NuevoReg;
                    Patch(
                        'Seguimiento Comprobantes';
                        Defaults('Seguimiento Comprobantes');
                        {
                            'Numero de Comprobante': NuevoReg.'Numero de Comprobante';
                            Transportista: NuevoReg.Transportista;
                            Cliente: NuevoReg.Cliente;
                            'Estado de Recepción': NuevoReg.'Estado de Recepción';
                            Observaciones: NuevoReg.Observaciones
                                //Attachments: NuevoReg.Attachments
                        }
                    )
                );;
             */   
                //resguardo modificados
            ForAll(
                    ListaModificados As ModifReg,
                    Patch(
                        'Seguimiento Comprobantes',
                        LookUp(
                            'Seguimiento Comprobantes',
                            'Seguimiento Comprobantes' = ModifReg.'Seguimiento Comprobantes'
                        ),
                        {
                            'Numero de Comprobante': ModifReg.'Numero de Comprobante',
                            Transportista: ModifReg.Transportista,
                            Cliente: ModifReg.Cliente,
                            'Estado de Recepción': ModifReg.'Estado de Recepción',
                            Observaciones: ModifReg.Observaciones,
                            'Foto Adjunta 1': ModifReg.'Foto Adjunta 1',
                            'Foto Adjunta 2': ModifReg.'Foto Adjunta 2',
                            'Foto Adjunta 3': ModifReg.'Foto Adjunta 3',
                            'Foto Adjunta 4': ModifReg.'Foto Adjunta 4'
                                //Attachments: ModifReg.Attachments
                        }
                    )
                ),
                Notify(
                    "No se encontro acceso a internet",
                    NotificationType.Error,
                    1500
                )
            );
            If(
                Connection.Connected,
                //Limpieza
                Clear(contactosClientesCollect);
                Clear(contactosTransportesCollect);
                Clear(seguimientoFacturasCollect);
                ClearData("contactosClientesData");
                ClearData("contactosTransportesData");
                ClearData("seguimientoFacturasData");
                
            //consulto de dataverse
            Concurrent(
                Collect(contactosClientesCollect,
                    SortByColumns(
                        Filter(Contactos, 
                                statecode exactin  "Activo" &&  
                                pss_tipodecontactoseguimiento exactin "Cliente"  &&  
                                !IsBlank(pss_cuit) && pss_cuit <> ""), 
                                "pss_nombrefullcontacto", SortOrder.Ascending) 
                    
                ),
                Collect(contactosTransportesCollect,
                SortByColumns(
                    Filter(Contactos, 
                    statecode exactin  "Activo" &&  
                    pss_tipodecontactoseguimiento exactin "Transporte"  &&  
                    !IsBlank(pss_razonsocial) && pss_razonsocial <> ""), 
                    "pss_nombrefullcontacto", SortOrder.Ascending) 
                    
                ),
                Collect(seguimientoFacturasCollect,
                    AddColumns(
                        Filter('Seguimiento Comprobantes', statecode exactin  "Activo" ), 
                        "IdLocal", GUID(), "Online", true
                    )
                )
            );
             
            ClearData("contactosClientesData");
                ClearData("contactosTransportesData");
                ClearData("seguimientoFacturasData");
                //guardo en memoria
                SaveData(
                    contactosClientesCollect,
                    "contactosClientesData"
                );
                SaveData(
                    contactosTransportesCollect,
                    "contactosTransportesData"
                );
                SaveData(
                    seguimientoFacturasCollect,
                    "seguimientoFacturasData"
                );
                SaveData(
                    tipoContactoOpcionesCollect,
                    "tipoContactoOpcionesData"
                );
                SaveData(
                    estadoRecepcionOpcionesCollect,
                    "estadoRecepcionOpcionesData"
                );
                
            );
            UpdateContext({ mostrarModalRefresh:false});
            Navigate(srcOk,Transition.Push)
        PressedBorderColor: =
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Size: =24
        Text: =""
        Width: =56
        X: =483
        Y: =5
        ZIndex: =7

    "ListadoSeguimiento_2 As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver4.0'":
        BorderColor: =RGBA(32, 54, 71, 1)
        Height: =955
        Items: |-
            =        Filter(//por estado
                        cloneData,
                        Text(estado_recepcion1) in Text('Estado de Recepción'),
                        Online = false // solo los modificados
                    )
                    //;
              /* Filter(//por estado
                        cloneData;
                        //pss_estadoderecepcion exactin Text(galConfigEstados.Selected.valor) && 
                        Online = !(soloSinGuardar)
            
                    )
                    */
            //If(
              /*  !(soloSinGuardar);
                Filter(//solo offline
                    cloneData;
                    Online = !(soloSinGuardar)
                );*/
                //If(
                    //!IsBlankOrError(estado_recepcion);
                    //Filter(//por estado
                    //    cloneData;
                    //   Text(estado_recepcion1) in Text('Estado de Recepción');
                    //    Online = If(soloSinGuardar;false;true)
                    //);
                    //cloneData
                //)
            //)
             
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Controls
        TemplatePadding: =0
        TemplateSize: =118
        Y: =177
        ZIndex: =8

        Title2_2 As label:
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =15
            Text: |-
                ="# Factura " & ThisItem.'Numero de Comprobante'
            VerticalAlign: =VerticalAlign.Top
            Width: =522
            X: =45
            Y: =6
            ZIndex: =1

        Subtitle2_2 As label:
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =20
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =9
            Text: ="Seguim." &  ThisItem.'Numero de Seguimiento'
            VerticalAlign: =VerticalAlign.Top
            Width: =209
            X: =416
            Y: =94
            ZIndex: =2

        Body1_2 As label:
            Align: =Align.Justify
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =108
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =11
            Text: |
                =//"Estado de Recepción: " & ThisItem.'Estado de Recepción' & 
                "Cliente: " & ThisItem.Cliente.'Nombre Full Contacto' & " 
                Transportista: " & ThisItem.Transportista.'Nombre Full Contacto'  & " 
                Destino: " & Upper(ThisItem.Destino.Name)
            Width: =580
            X: =45
            Y: =6
            ZIndex: =3

        Separator2_2 As rectangle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =RGBA(32, 54, 71, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =5

        Circle1_2 As circle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: |-
                =/*
                rojo  RGBA(255; 0; 0; 1)
                amarillo RGBA(255; 255; 0; 1)
                verde RGBA(152; 208; 70; 1)
                */
                Switch(
                    Text(ThisItem.'Estado de Recepción'),
                    "Recibido",
                    RGBA(
                        152,
                        208,
                        70,
                        1
                    ),
                    "Observado",
                    RGBA(
                        255,
                        255,
                        0,
                        1
                    ),
                    "Rechazado",
                    RGBA(
                        255,
                        0,
                        0,
                        1
                    )
                )
            Height: =30
            Width: =30
            X: =6
            Y: =45
            ZIndex: =6

        IsOnline As label:
            Align: =Align.Right
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Bold
            Height: =27
            Size: =12
            Text: =If(ThisItem.Online,"SIN CAMBIOS","CAMBIOS PENDIENTES")
            Width: =211
            X: =399
            Y: =6
            ZIndex: =7

    Icon6 As icon.Reload:
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(32, 54, 71, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =46
        Icon: =Icon.Reload
        OnSelect: |-
            =UpdateContext({ soloSinGuardar1: false, estado_recepcion1: "" })
        Width: =39
        X: =491
        Y: =86
        ZIndex: =9

    Icon5 As icon.Cancel:
        BorderColor: =RGBA(32, 54, 71, 1)
        Color: =RGBA(32, 54, 71, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =50
        Icon: =Icon.Cancel
        OnSelect: =Back(ScreenTransition.Fade)
        Width: =50
        X: =570
        Y: =5
        ZIndex: =17

    Preloader_3 As Preloader:
        IsLoading: =mostrarModalRefresh
        Text: ="GUARDANDO..."
        Visible: =Preloader_3.IsLoading
        ZIndex: =18

    ModalRefresh As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =21

        Rectangle3 As rectangle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =RGBA(230, 230, 230, 0.7)
            Height: =1136
            Visible: =false//mostrarModalRefresh
            Width: =640
            ZIndex: =10

        Rectangle4 As rectangle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =502
            Visible: =false//mostrarModalRefresh
            Width: =612
            X: =12
            Y: =241
            ZIndex: =11

        Label3 As label:
            Align: =Align.Center
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =70
            Size: =21
            Text: ="Aguarde un momento..."
            Visible: =false//mostrarModalRefresh
            Width: =640
            Y: =419
            ZIndex: =12

        Icon7 As icon.Globe:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(32, 54, 71, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Icon: =Icon.Globe
            Visible: =false//mostrarModalRefresh
            Width: =72
            X: =472
            Y: =512
            ZIndex: =13

        Icon8 As icon.Sync:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(32, 54, 71, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Icon: =Icon.Sync
            Visible: =false//mostrarModalRefresh
            Width: =72
            X: =284
            Y: =512
            ZIndex: =14

        Label6 As label:
            Align: =Align.Center
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FontWeight: =FontWeight.Semibold
            Height: =64
            Size: =21
            Text: =">>>>>>>>>"
            Visible: =false//mostrarModalRefresh
            Width: =640
            Y: =584
            ZIndex: =15

        Icon9 As icon.Database:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =RGBA(32, 54, 71, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Icon: =Icon.Database
            Visible: =false//mostrarModalRefresh
            Width: =72
            X: =110
            Y: =512
            ZIndex: =16

